<!DOCTYPE html>
<html lang="zh-Hant-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>Carlos ç”Ÿæ—¥æ‘˜æ˜Ÿæ˜Ÿ</title>
    <link rel="manifest" href="manifest.json">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link href="fonts.googleapis.com" rel="stylesheet">
    <style>
        :root { --blue: #7d9ba6; --gray: #f0f0f0; --bg: #f5f7f8; --text: #4a4a4a; --accent: #d4a373; --shadow: 0 8px 24px rgba(149, 157, 165, 0.1); }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { font-family: 'Zen Maru Gothic', sans-serif; background: var(--bg); color: var(--text); margin: 0; padding-bottom: 110px; line-height: 1.5; }
        .top-fixed-bar { position: sticky; top: 0; left: 0; right: 0; background: linear-gradient(145deg, #8ba8b1, #5c7b84); color: white; padding: 55px 20px 25px; z-index: 200; box-shadow: 0 6px 20px rgba(0,0,0,0.15), inset 0 1px 0 rgba(255,255,255,0.2); border-bottom-left-radius: 30px; border-bottom-right-radius: 30px; text-align: center; }
        .app-main-title { font-size: 1.4rem; font-weight: 900; letter-spacing: 4px; margin: 0; text-shadow: 2px 3px 6px rgba(0,0,0,0.4); }
        .date-slider { display: flex; overflow-x: auto; background: rgba(255,255,255,0.8); backdrop-filter: blur(10px); padding: 15px; gap: 12px; scrollbar-width: none; position: sticky; top: 110px; z-index: 90; margin-bottom: 5px; }
        .date-slider::-webkit-scrollbar { display: none; }
        .date-btn { display: flex; flex-direction: column; align-items: center; justify-content: center; min-width: 55px; height: 65px; border-radius: 18px; background: white; border: none; flex-shrink: 0; transition: 0.3s; box-shadow: 0 2px 8px rgba(0,0,0,0.03); }
        .date-btn .wk { font-size: 0.75rem; font-weight: 700; color: #999; margin-bottom: 4px; }
        .date-btn .dt { font-size: 1rem; color: #555; font-weight: 700; }
        .date-btn.active { background: var(--blue); transform: translateY(-2px); box-shadow: 0 5px 15px rgba(125, 155, 166, 0.3); }
        .date-btn.active .wk, .date-btn.active .dt { color: white; }
        .container { padding: 15px; }
        .card { background: white; border-radius: 20px; padding: 20px; margin-bottom: 15px; box-shadow: var(--shadow); position: relative; border: none; transition: transform 0.2s; cursor: pointer; }
        .card:active { transform: scale(0.98); }
        .flight-card { background: rgba(125, 155, 166, 0.75) !important; backdrop-filter: blur(5px); color: white !important; cursor: default !important; transform: none !important; border: 1px solid rgba(255,255,255,0.2); }
        .flight-info-row { display: flex; justify-content: space-between; align-items: center; margin-top: 15px; position: relative; }
        .flight-path { flex: 1; border-bottom: 2px dashed rgba(255,255,255,0.4); margin: 0 15px; position: relative; height: 0; }
        .plane-svg { position: absolute; top: -10px; left: 50%; transform: translateX(-50%); width: 20px; height: 20px; fill: white; }
        .airport-block { text-align: center; }
        .airport-code { font-size: 1.8rem; font-weight: 900; letter-spacing: 1px; }
        .flight-time { font-size: 0.85rem; opacity: 0.9; margin-top: 4px; font-weight: 700; }
        .type-tag { font-size: 0.65rem; color: white; background: #bbb; padding: 3px 10px; border-radius: 50px; display: inline-block; margin-bottom: 8px; font-weight: 700; }
        .tag-é¤å»³ { background: #e67e22; }
        .tag-å’–å•¡å»³ { background: #d4a373; }
        .tag-æ™¯é» { background: #3498db; }
        .tag-è³¼ç‰© { background: #e91e63; }
        .tag-äº¤é€š { background: #95a5a6; }
        .tag-ä½å®¿ { background: #9b59b6; }
        .img-view-btn { display: inline-flex; align-items: center; gap: 5px; color: #666; font-size: 0.85rem; margin-top: 5px; text-decoration: underline; cursor: pointer; }
        .addr-link { color: var(--blue); font-size: 0.85rem; text-decoration: underline; margin-top: 8px; display: inline-flex; align-items: center; gap: 5px; background: #f9f9f9; padding: 8px 12px; border-radius: 10px; width: 100%; }
        .bottom-nav { position: fixed; bottom: 0; width: 100%; height: 75px; background: rgba(255,255,255,0.9); backdrop-filter: blur(15px); display: flex; border-top: 1px solid rgba(0,0,0,0.05); padding-bottom: env(safe-area-inset-bottom); z-index: 1000; }
        .nav-tab { flex: 1; border:none; background:none; color: #aaa; display: flex; flex-direction: column; align-items: center; justify-content: center; font-size: 0.7rem; font-weight: 700; }
        .nav-tab.active { color: var(--blue); }
        .fab { position: fixed; bottom: 90px; right: 20px; width: 60px; height: 60px; background: var(--blue); border-radius: 50%; display: flex; align-items: center; justify-content: center; box-shadow: 0 8px 20px rgba(125, 155, 166, 0.4); border: none; z-index: 500; }
        .modal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.5); z-index: 2000; align-items: center; justify-content: center; backdrop-filter: blur(5px); }
        .modal-content { background: white; width: 90%; max-height: 85vh; border-radius: 30px; padding: 25px; overflow-y: auto; }
        input, select, textarea { width: 100%; padding: 12px; margin: 8px 0 15px; border: 1px solid #eee; border-radius: 12px; font-size: 1rem; }
        .field-lbl { font-size: 0.85rem; color: #666; font-weight: 700; }
        .save-btn { background: var(--blue); color: white; border: none; padding: 15px; border-radius: 12px; width: 100%; font-weight: 700; margin-top: 10px; }
        .cancel-btn { width: 100%; border: none; background: none; color: #aaa; margin-top: 10px; }
        .del-btn { border:none; background:none; color:#ccc; font-size:0.8rem; padding: 5px; }
        .img-overlay { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.9); z-index: 3000; align-items: center; justify-content: center; padding: 20px; }
        .close-img-btn { position: absolute; top: 40px; right: 20px; width: 40px; height: 40px; background: white; border-radius: 50%; border: none; font-size: 20px; }
        .day-sum-header { background: var(--blue); color: white; padding: 10px 15px; border-radius: 12px; margin: 20px 0 10px; font-weight: 700; font-size: 0.95rem; }
    </style>
</head>
<body>
<div class="top-fixed-bar"><div class="app-main-title">Carlos ç”Ÿæ—¥æ‘˜æ˜Ÿæ˜Ÿ</div></div>
<div class="date-slider" id="dateSlider"></div>
<div class="container" id="mainView"></div>
<div id="imgOverlay" class="img-overlay" onclick="this.style.display='none'">
    <button class="close-img-btn" onclick="event.stopPropagation(); document.getElementById('imgOverlay').style.display='none'">âœ•</button>
    <img id="overlayImg" src="" style="max-width:100%; max-height:85vh; border-radius:10px;">
</div>
<button class="fab" onclick="openModal()"><svg viewBox="0 0 24 24" width="28" height="28" stroke="white" stroke-width="3" fill="none"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg></button>
<nav class="bottom-nav">
    <button class="nav-tab active" onclick="goTab('trip')">è¡Œç¨‹</button>
    <button class="nav-tab" onclick="goTab('todo')">TODO</button>
    <button class="nav-tab" onclick="goTab('back')">å‚™æ¡ˆ</button>
    <button class="nav-tab" onclick="goTab('wallet')">è¨˜å¸³</button>
</nav>
<div id="modal" class="modal"><div class="modal-content" id="modalInner"></div></div>
<script>
    let day = 0, tab = 'trip', editingIdx = null, tempImgBase64 = "";
    const store = (k, v) => v !== undefined ? localStorage.setItem(k, JSON.stringify(v)) : JSON.parse(localStorage.getItem(k));
    const saveAndRender = (key, data) => { store(key, data); render(); };
    const weekdays = ['SUN','MON','TUE','WED','THU','FRI','SAT'];
    const fmt = (num) => Number(num || 0).toLocaleString();
   
    let tripData = store('c_trip_final_v5') || Array(8).fill().map(()=>[]);
    let backData = store('c_back_v2') || [];
    let todoData = store('c_todo') || [];
    let wallData = store('c_wall_all') || [];
    let exchangeRate = parseFloat(localStorage.getItem('c_rate')) || 0.21;

    /**
     * å„ªåŒ–å¾Œçš„ Google Maps è·³è½‰å‡½æ•¸
     * 1. è£œå…¨ https://
     * 2. åŠ å…¥ /maps/search/ ç¢ºä¿è·¯å¾‘æ­£ç¢º
     * 3. ä½¿ç”¨å‚³çµ±å­—ä¸²ç›¸åŠ é¿å…æ¨£æ¿å­—ä¸² (Template Literals) è§£æéŒ¯èª¤
     */
    function goMap(e, addr) { 
        if (e && e.stopPropagation) e.stopPropagation(); 
        if (!addr) return; 
        var url = 'www.google.com' + encodeURIComponent(addr.trim());
        window.open(url, '_blank'); 
    }

    function showBigImg(e, src) { e.stopPropagation(); document.getElementById('overlayImg').src = src; document.getElementById('imgOverlay').style.display = 'flex'; }
    function updateRate(val) { exchangeRate = parseFloat(val) || 0.21; localStorage.setItem('c_rate', exchangeRate); render(); }
   
    function formatAmount(input) { 
        let v = input.value.replace(/,/g, ''); 
        if (v === "") return;
        if (!isNaN(v) && isFinite(v)) input.value = parseFloat(v).toLocaleString(); 
    }

    function handleImg(file) {
        if (!file) return;
        const reader = new FileReader();
        reader.onload = (e) => {
            const img = new Image();
            img.onload = () => {
                const canvas = document.createElement('canvas');
                const MAX = 800; let w = img.width, h = img.height;
                if (w > MAX) { h *= MAX / w; w = MAX; }
                canvas.width = w; canvas.height = h;
                canvas.getContext('2d').drawImage(img, 0, 0, w, h);
                tempImgBase64 = canvas.toDataURL('image/jpeg', 0.7);
                document.getElementById('img_preview').src = tempImgBase64;
                document.getElementById('img_preview').style.display = 'block';
                document.getElementById('img_placeholder').style.display = 'none';
                if(document.getElementById('remove_img_btn')) document.getElementById('remove_img_btn').style.display = 'block';
            };
            img.src = e.target.result;
        };
        reader.readAsDataURL(file);
    }

    function triggerImgUpload() { const i = document.createElement('input'); i.type = 'file'; i.accept = 'image/*'; i.onchange = (e) => handleImg(e.target.files); i.click(); }
    function goTab(t) { tab = t; render(); }

    const whitePlaneSVG = `<svg class="plane-svg" viewBox="0 0 24 24"><path d="M21,16L21,14L13,9L13,3.5A1.5,1.5 0 0,0 11.5,2A1.5,1.5 0 0,0 10,3.5L10,9L2,14L2,16L10,13.5L10,19L8,20.5L8,22L11.5,21L15,22L15,20.5L13,19L13,13.5L21,16Z"/></svg>`;

    function render() {
        const view = document.getElementById('mainView');
        const slider = document.getElementById('dateSlider');
        slider.style.display = (tab === 'trip') ? 'flex' : 'none';
        document.querySelectorAll('.nav-tab').forEach((n,i)=>n.classList.toggle('active', ['trip','todo','back','wallet'].indexOf(tab)===i));
       
        let h = '';
        if(tab === 'trip') {
            slider.innerHTML = '';
            for(let i=0; i<8; i++){
                let d = new Date(2025, 11, 24+i);
                slider.innerHTML += `<button class="date-btn ${i===day?'active':''}" onclick="day=${i};render()"><span class="wk">${weekdays[d.getDay()]}</span><span class="dt">${d.getDate()}</span></button>`;
            }
            if(day === 0) {
                h += `<div class="card flight-card">
                    <div style="font-size:0.75rem; opacity:0.8; font-weight:700;">è¯èˆª CI154 | 12/24 DEPARTURE</div>
                    <div class="flight-info-row">
                        <div class="airport-block"><div class="airport-code">TPE</div><div class="flight-time">07:35</div></div>
                        <div class="flight-path">${whitePlaneSVG}</div>
                        <div class="airport-block"><div class="airport-code">NGO</div><div class="flight-time">11:05</div></div>
                    </div></div>`;
            }
            if(day === 7) {
                h += `<div class="card flight-card">
                    <div style="font-size:0.75rem; opacity:0.8; font-weight:700;">è¯èˆª CI109 | 12/31 RETURN</div>
                    <div class="flight-info-row">
                        <div class="airport-block"><div class="airport-code">NRT</div><div class="flight-time">19:30</div></div>
                        <div class="flight-path">${whitePlaneSVG}</div>
                        <div class="airport-block"><div class="airport-code">TPE</div><div class="flight-time">22:45</div></div>
                    </div></div>`;
            }
            tripData[day].forEach((item, idx) => {
                h += `<div class="card" onclick="openModal(${idx})">
                    <span class="type-tag tag-${item.type}">${item.type}</span>
                    <div style="font-weight:700; font-size:1.15rem; color:#333;">${item.time} ${item.title}</div>
                    ${item.loc ? `<div class="addr-link" onclick="goMap(event, '${item.loc.replace(/'/g, "\\'")}')">ğŸ“ ${item.loc}</div>` : ''}
                    ${item.img ? `<div class="img-view-btn" onclick="showBigImg(event, '${item.img}')">ğŸ“ƒ ç›¸é—œåœ–ç‰‡ç´€éŒ„</div>` : ''}
                    ${item.note ? `<div style="font-size:0.85rem; color:#777; margin-top:12px; background:#f9f9f9; padding:12px; border-radius:12px; border-left:4px solid var(--blue);">${item.note}</div>` : ''}
                    <div style="margin-top:15px; text-align:right;"><button class="del-btn" onclick="event.stopPropagation(); deleteItem(${idx})">åˆªé™¤</button></div>
                </div>`;
            });
        } else if(tab === 'todo') {
            todoData.forEach((item, idx) => {
                h += `<div class="card" onclick="openModal(${idx})" style="display:flex; align-items:center; justify-content:space-between;">
                        <div style="display:flex; align-items:center; gap:12px;"><input type="checkbox" ${item.done?'checked':''} onclick="event.stopPropagation(); toggleTodo(${idx})" style="width:20px; height:20px;"><span style="font-weight:700; ${item.done?'text-decoration:line-through;color:#ccc':''}">${item.txt}</span></div>
                        <button class="del-btn" onclick="event.stopPropagation(); deleteTodo(${idx})">åˆªé™¤</button>
                      </div>`;
            });
        } else if(tab === 'back') {
            backData.forEach((item, idx) => {
                h += `<div class="card" onclick="openModal(${idx})"><div style="font-weight:700; font-size:1.1rem; margin-bottom:8px;">${item.title}</div>${item.loc ? `<div class="addr-link" onclick="goMap(event, '${item.loc.replace(/'/g, "\\'")}')">ğŸ“ ${item.loc}</div>` : ''}<div style="margin-top:12px; text-align:right;"><button class="del-btn" onclick="event.stopPropagation(); deleteBack(${idx})">åˆªé™¤</button></div></div>`;
            });
        } else if(tab === 'wallet') {
            let totalAll = wallData.reduce((a,b)=>a+Number(b.amt), 0);
            h += `<div class="card" style="display:flex; align-items:center; gap:12px;"><span style="font-size:0.85rem; font-weight:700;">åŒ¯ç‡è¨­å®š:</span><input type="number" step="0.001" value="${exchangeRate}" onchange="updateRate(this.value)" style="margin:0; flex:1;"></div>`;
            let grouped = {}; wallData.forEach(item => { if(!grouped[item.date]) grouped[item.date] = []; grouped[item.date].push(item); });
            Object.keys(grouped).sort().reverse().forEach(date => {
                let daySum = grouped[date].reduce((a,b)=>a+Number(b.amt), 0);
                h += `<div class="day-sum-header"><span>${date}</span> <span style="float:right;">Â¥ ${fmt(daySum)}</span></div>`;
                grouped[date].forEach((item) => {
                    let gIdx = wallData.indexOf(item);
                    h += `<div class="card" onclick="openModal(${gIdx})">
                            <div style="display:flex; justify-content:space-between; align-items:center;">
                                <div><div style="font-weight:700;">${item.desc}</div><span style="font-size:0.7rem; color:#888;">${item.method} Â· ${item.payer}</span></div>
                                <div style="text-align:right;"><div style="font-weight:700; color:var(--blue);">Â¥ ${fmt(item.amt)}</div><div style="font-size:0.75rem; color:#aaa;">â‰ˆ NT$ ${fmt(Math.round(item.amt * exchangeRate))}</div></div>
                            </div>
                            <div style="margin-top:10px; text-align:right;"><button class="del-btn" onclick="event.stopPropagation(); deleteWall(${gIdx})">åˆªé™¤</button></div>
                        </div>`;
                });
            });
            h += `<div style="background:linear-gradient(135deg, #7d9ba6, #5c7b84); color:white; padding:25px; border-radius:25px; margin-top:30px; text-align:center;"><div style="font-size:0.8rem; opacity:0.9;">ç¸½é ç®—ç´¯è¨ˆ</div><div style="font-size:2rem; font-weight:900; margin:5px 0;">Â¥ ${fmt(totalAll)}</div><div style="font-size:1rem; opacity:0.8; font-weight:700;">ç´„ NT$ ${fmt(Math.round(totalAll * exchangeRate))}</div></div>`;
        }
        view.innerHTML = h || `<div style="text-align:center; color:#ccc; margin-top:80px; font-weight:700;">ç›®å‰æ²’æœ‰è³‡æ–™</div>`;
    }

    function openModal(idx = null) {
        editingIdx = idx; const m = document.getElementById('modal'); const inner = document.getElementById('modalInner'); m.style.display = 'flex';
        if(tab === 'trip') {
            const d = idx !== null ? tripData[day][idx] : {type:'æ™¯é»', title:'', time:'09:00', loc:'', note:'', img:''};
            tempImgBase64 = d.img || "";
            inner.innerHTML = `
                <h3 style="color:var(--blue);">${idx !== null ? 'ç·¨è¼¯è¡Œç¨‹' : 'æ–°å¢è¡Œç¨‹'}</h3>
                <label class="field-lbl">è¡Œç¨‹åˆ†é¡</label><select id="f_type">${['é¤å»³','å’–å•¡å»³','è³¼ç‰©','æ™¯é»','ä½å®¿','äº¤é€š','å…¶ä»–'].map(t=>`<option ${d.type===t?'selected':''}>${t}</option>`).join('')}</select>
                <label class="field-lbl">åœ°é»åç¨±</label><input id="f_title" value="${d.title}">
                <label class="field-lbl">æ™‚é–“</label><input id="f_time" type="time" value="${d.time}">
                <label class="field-lbl">åœ°å€</label><input id="f_loc" value="${d.loc}">
                <label class="field-lbl">å‚™è¨»</label><textarea id="f_note" rows="3">${d.note}</textarea>
                <label class="field-lbl">åœ–ç‰‡ç´€éŒ„</label>
                <div onclick="triggerImgUpload()" style="cursor:pointer; border: 2px dashed #ddd; padding: 20px; text-align: center; border-radius: 15px; background: #fafafa;">
                   <img id="img_preview" src="${tempImgBase64}" style="max-width:100%; height:auto; display:${tempImgBase64?'block':'none'}; border-radius:10px; margin:0 auto;">
                   <div id="img_placeholder" style="display:${tempImgBase64?'none':'block'}; color:#aaa;">ğŸ“¸ é»æ“Šé¸æ“‡åœ–ç‰‡</div>
                </div>
                <button id="remove_img_btn" onclick="tempImgBase64=''; document.getElementById('img_preview').style.display='none'; document.getElementById('img_placeholder').style.display='block'; this.style.display='none';" style="display:${tempImgBase64?'block':'none'}; width:100%; background:none; border:none; color:#e74c3c; font-size:0.85rem; margin-top:8px; text-decoration:underline;">ç§»é™¤åœ–ç‰‡</button>
                <button class="save-btn" onclick="saveTrip()">å„²å­˜è®Šæ›´</button>
                <button class="cancel-btn" onclick="closeModal()">å–æ¶ˆ</button>`;
        } else if(tab === 'todo') {
            const d = idx !== null ? todoData[idx] : {txt:''};
            inner.innerHTML = `<h3>TODO äº‹é …</h3><input id="f1" value="${d.txt}" placeholder="è¼¸å…¥å…§å®¹..."><button class="save-btn" onclick="saveTodo()">å„²å­˜</button><button class="cancel-btn" onclick="closeModal()">å–æ¶ˆ</button>`;
        } else if(tab === 'back') {
            const d = idx !== null ? backData[idx] : {title:'', loc:''};
            inner.innerHTML = `<h3>å‚™æ¡ˆå„²å­˜</h3><label class="field-lbl">åç¨±</label><input id="f1" value="${d.title}"><label class="field-lbl">åœ°å€</label><input id="f2" value="${d.loc}"><button class="save-btn" onclick="saveBack()">å„²å­˜</button><button class="cancel-btn" onclick="closeModal()">å–æ¶ˆ</button>`;
        } else if(tab === 'wallet') {
            const d = idx !== null ? wallData[idx] : {date:'2025-12-24', method:'ç¾é‡‘', payer:'Carlos', desc:'', amt:''};
            inner.innerHTML = `<h3>æ¶ˆè²»è¨˜å¸³</h3><label class="field-lbl">æ—¥æœŸ</label><input id="w1" type="date" value="${d.date}"><label class="field-lbl">ä»˜æ¬¾</label><select id="w2">${['ç¾é‡‘','åˆ·å¡','äº¤é€šå¡'].map(m=>`<option ${d.method===m?'selected':''}>${m}</option>`).join('')}</select><label class="field-lbl">æ”¯ä»˜äºº</label><select id="w3">${['Carlos','Ivy'].map(p=>`<option ${d.payer===p?'selected':''}>${p}</option>`).join('')}</select><label class="field-lbl">èªªæ˜</label><input id="w4" value="${d.desc}"><label class="field-lbl">é‡‘é¡ (JPY)</label><input id="w5" type="text" oninput="formatAmount(this)" value="${d.amt ? fmt(d.amt) : ''}"><button class="save-btn" onclick="saveWall()">ç´€éŒ„å¸³ç›®</button><button class="cancel-btn" onclick="closeModal()">å–æ¶ˆ</button>`;
        }
    }

    function closeModal() { document.getElementById('modal').style.display = 'none'; editingIdx = null; tempImgBase64 = ""; }
   
    function saveTrip() {
        const item = { type: document.getElementById('f_type').value, title: document.getElementById('f_title').value, time: document.getElementById('f_time').value, loc: document.getElementById('f_loc').value, note: document.getElementById('f_note').value, img: tempImgBase64 };
        if(!item.title) return;
        if(editingIdx !== null) tripData[day][editingIdx] = item; else tripData[day].push(item);
        tripData[day].sort((a,b)=>a.time.localeCompare(b.time));
        saveAndRender('c_trip_final_v5', tripData); closeModal();
    }
    function saveTodo() {
        const t = document.getElementById('f1').value; if(!t) return;
        if(editingIdx !== null) todoData[editingIdx].txt = t; else todoData.push({txt:t, done:false});
        saveAndRender('c_todo', todoData); closeModal();
    }
    function toggleTodo(idx) { todoData[idx].done = !todoData[idx].done; saveAndRender('c_todo', todoData); }
    function saveBack() {
        const t = document.getElementById('f1').value, l = document.getElementById('f2').value; if(!t) return;
        if(editingIdx !== null) backData[editingIdx] = {title:t, loc:l}; else backData.push({title:t, loc:l});
        saveAndRender('c_back_v2', backData); closeModal();
    }
    function saveWall() {
        const a = document.getElementById('w5').value.replace(/,/g, ''); 
        const item = { date: document.getElementById('w1').value, method: document.getElementById('w2').value, payer: document.getElementById('w3').value, desc: document.getElementById('w4').value, amt: Number(a) };
        if(!item.desc || !item.amt) return;
        if(editingIdx !== null) wallData[editingIdx] = item; else wallData.push(item);
        saveAndRender('c_wall_all', wallData); closeModal();
    }
    function deleteItem(idx) { if(confirm('ç¢ºå®šåˆªé™¤è¡Œç¨‹ï¼Ÿ')) { tripData[day].splice(idx,1); saveAndRender('c_trip_final_v5', tripData); } }
    function deleteBack(idx) { if(confirm('ç¢ºå®šåˆªé™¤å‚™æ¡ˆï¼Ÿ')) { backData.splice(idx,1); saveAndRender('c_back_v2', backData); } }
    function deleteWall(idx) { if(confirm('ç¢ºå®šåˆªé™¤ï¼Ÿ')) { wallData.splice(idx,1); saveAndRender('c_wall_all', wallData); } }
    function deleteTodo(idx) { if(confirm('ç¢ºå®šåˆªé™¤æ­¤é …ç›®ï¼Ÿ')) { todoData.splice(idx,1); saveAndRender('c_todo', todoData); } }

    render();
</script>
</body>
</html>
